2025-08-17 18:59:19 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 18:59:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 32916 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 18:59:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 1 JPA repository interface.
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 18:59:20 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 18:59:20 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 18:59:20 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 18:59:20 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 18:59:20 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 18:59:20 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1033 ms
2025-08-17 18:59:20 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 18:59:21 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 18:59:21 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 18:59:21 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 18:59:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 18:59:21 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2a510e0e
2025-08-17 18:59:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 18:59:21 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 18:59:21 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 18:59:22 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 18:59:22 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 18:59:23 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 18:59:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 18:59:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@633e4742]]
2025-08-17 18:59:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 18:59:23 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 18:59:23 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 18:59:23 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 18:59:23 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 18:59:23 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 18:59:23 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 18:59:23 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 18:59:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 18:59:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 18:59:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755428363803
2025-08-17 18:59:23 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 18:59:23 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 18:59:23 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 18:59:23 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.409 seconds (process running for 5.34)
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=25, memberId='consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645', protocol='range'}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 25: {consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645=Assignment(partitions=[machine.notifications-0])}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=25, memberId='consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645', protocol='range'}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=29, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-03, timestamp=2025-08-17T10:59:47.581Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-03, timestamp=2025-08-17T10:59:47.581Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:00:16 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@633e4742]]
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:05:19 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:05:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 6268 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:05:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 1 JPA repository interface.
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 19:05:20 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:05:20 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:05:20 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:05:20 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:05:20 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:05:20 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1117 ms
2025-08-17 19:05:20 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:05:20 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:05:20 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:05:21 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:05:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:05:21 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@495e8a3
2025-08-17 19:05:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:05:21 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:05:21 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:05:22 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:05:22 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:05:23 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:05:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:05:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@23110196]]
2025-08-17 19:05:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:05:23 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:05:23 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:05:23 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:05:23 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:05:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:05:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:05:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755428723755
2025-08-17 19:05:23 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:05:23 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.698 seconds (process running for 5.592)
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=27, memberId='consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc', protocol='range'}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 27: {consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=27, memberId='consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc', protocol='range'}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:05:25 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:05:25 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:05:25 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 19:05:25 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:05:25 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - dateMap: {startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T18:40:03Z}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dateMap: {startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T18:40:03Z}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:06:23 INFO  [MessageBroker-6] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(1)], stompBrokerRelay[null], inboundChannel[pool size = 18, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 1, completed tasks = 13]
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:10:57 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@23110196]]
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:11:01 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:11:01 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 40880 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:11:01 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 100 ms. Found 1 JPA repository interface.
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 19:11:02 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:11:02 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:11:02 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:11:02 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:11:03 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:11:03 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1171 ms
2025-08-17 19:11:03 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:11:03 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:11:03 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:11:03 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:11:03 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:11:03 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@5de335cf
2025-08-17 19:11:03 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:11:03 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:11:03 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:11:04 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:11:04 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:11:05 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:11:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:11:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@24456c9e]]
2025-08-17 19:11:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:11:05 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:11:05 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:11:05 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:11:05 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:11:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:11:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:11:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755429065777
2025-08-17 19:11:05 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:11:05 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.447 seconds (process running for 5.041)
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=29, memberId='consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798', protocol='range'}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 29: {consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=29, memberId='consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798', protocol='range'}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:11:36 INFO  [http-nio-8082-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:11:36 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:11:36 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 19:11:36 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:11:36 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T11:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dates: []
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - series: []
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Daily count {series=[], categories=[]}
2025-08-17 19:12:05 INFO  [MessageBroker-8] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(1)], stompBrokerRelay[null], inboundChannel[pool size = 18, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 1, completed tasks = 6]
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T10:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}]
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}], categories=[2025-08-17]}
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:13:00 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@24456c9e]]
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:13:04 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:13:04 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 39472 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:13:04 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 84 ms. Found 1 JPA repository interface.
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 19:13:05 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:13:05 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:05 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:13:05 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:13:05 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:13:05 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1206 ms
2025-08-17 19:13:06 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:13:06 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:13:06 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:13:06 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:13:06 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:13:06 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3cf70afa
2025-08-17 19:13:06 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:13:06 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:13:06 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:13:07 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:13:07 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:08 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:13:08 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:13:08 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@584f12eb]]
2025-08-17 19:13:08 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:13:08 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:08 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:13:08 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:13:08 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:13:08 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:13:08 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:13:08 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755429188990
2025-08-17 19:13:08 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:13:09 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.751 seconds (process running for 5.448)
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=31, memberId='consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1', protocol='range'}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 31: {consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=31, memberId='consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1', protocol='range'}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:13:18 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:13:18 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:13:18 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-01T10:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dates: [2025-08-16, 2025-08-17]
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - series: [{data=[0, 12], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 0], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}]
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Daily count {series=[{data=[0, 12], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 0], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}], categories=[2025-08-16, 2025-08-17]}
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:13:44 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@584f12eb]]
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:13:55 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:13:55 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 16744 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:13:55 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:13:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 79 ms. Found 1 JPA repository interface.
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2025-08-17 19:13:56 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:13:56 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:56 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:13:56 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:13:56 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:13:56 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1172 ms
2025-08-17 19:13:56 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:13:56 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:13:56 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:13:56 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:13:56 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:13:57 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@23d978b
2025-08-17 19:13:57 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:13:57 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:13:57 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:13:57 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:13:57 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:58 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:13:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:13:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@45ec9b22]]
2025-08-17 19:13:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:13:59 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:59 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:13:59 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:13:59 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:13:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:13:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:13:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755429239322
2025-08-17 19:13:59 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:13:59 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.483 seconds (process running for 5.207)
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=33, memberId='consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6', protocol='range'}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 33: {consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=33, memberId='consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6', protocol='range'}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:14:15 INFO  [http-nio-8082-exec-3] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:14:15 INFO  [http-nio-8082-exec-3] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:14:15 INFO  [http-nio-8082-exec-3] o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-08-17 19:14:16 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:14:16 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-04, timestamp=2025-08-17T10:59:47.581Z, sensorType=VIBRATION_SENSOR, alertType=HIGH_VIBRATION, value=5.0)
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-04, timestamp=2025-08-17T10:59:47.581Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:14:59 INFO  [MessageBroker-10] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 12, active threads = 0, queued tasks = 0, completed tasks = 12], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 2, completed tasks = 10]
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-01, timestamp=2025-08-17T10:59:48.581Z, sensorType=VIBRATION_SENSOR, alertType=HIGH_VIBRATION, value=5.0)
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-01, timestamp=2025-08-17T10:59:48.581Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 19:32:02 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response. isDisconnected: false. Rediscovery will be attempted.
2025-08-17 19:32:02 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Requesting disconnect from last known coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:32:02 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Client requested disconnect from node 2147483647
2025-08-17 19:32:02 WARN  [HikariPool-1:housekeeper] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=6m5s572ms760µs).
2025-08-17 19:32:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:32:04 INFO  [clientInboundChannel-25] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:32:04 INFO  [clientInboundChannel-25] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:34:18 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@45ec9b22]]
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 20:24:40 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 20:24:40 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 26892 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 20:24:40 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 20:24:42 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 20:24:42 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 20:24:42 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 267 ms. Found 1 JPA repository interface.
2025-08-17 20:24:42 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 20:24:42 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 20:24:42 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 20:24:42 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-08-17 20:24:43 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 20:24:43 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 20:24:43 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 20:24:43 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 20:24:43 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 20:24:43 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2557 ms
2025-08-17 20:24:43 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 20:24:43 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 20:24:43 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 20:24:44 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 20:24:44 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 20:24:44 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@401b67a9
2025-08-17 20:24:44 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 20:24:44 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 20:24:44 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 20:24:46 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 20:24:46 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 20:24:48 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 20:24:48 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 20:24:48 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5cfcb55c]]
2025-08-17 20:24:48 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 20:24:48 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 20:24:48 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 20:24:48 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 20:24:48 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 20:24:48 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 20:24:48 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 20:24:48 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 20:24:49 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 20:24:49 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 20:24:49 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 20:24:49 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755433489129
2025-08-17 20:24:49 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 20:24:49 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 20:24:49 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 9.291 seconds (process running for 10.551)
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-c8331ead-9361-4afe-aa44-07558ced83cd
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=35, memberId='consumer-ws-forwarder-1-c8331ead-9361-4afe-aa44-07558ced83cd', protocol='range'}
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 35: {consumer-ws-forwarder-1-c8331ead-9361-4afe-aa44-07558ced83cd=Assignment(partitions=[machine.notifications-0])}
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=35, memberId='consumer-ws-forwarder-1-c8331ead-9361-4afe-aa44-07558ced83cd', protocol='range'}
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 20:24:50 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 20:25:48 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 12, active threads = 0, queued tasks = 0, completed tasks = 12], outboundChannel[pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 2, completed tasks = 14]
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T20:23:13Z)
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T20:23:13Z)
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 20:26:59 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 20:27:04 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 20:27:04 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-07-31T16:00:00Z, endDateTime=2025-08-17T20:23:13Z)
2025-08-17 20:27:04 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - dates: [2025-08-16, 2025-08-17]
2025-08-17 20:27:04 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - series: [{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}]
2025-08-17 20:27:04 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - Daily count {series=[{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}], categories=[2025-08-16, 2025-08-17]}
2025-08-17 20:55:48 INFO  [MessageBroker-10] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(1)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 1, completed tasks = 378]
2025-08-17 21:05:39 INFO  [clientInboundChannel-28] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 21:05:39 INFO  [clientInboundChannel-28] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T21:05:38Z)
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T21:05:38Z)
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-10] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 21:05:42 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 21:08:02 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:08:02 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-07-31T16:00:00Z, endDateTime=2025-08-17T21:05:38Z)
2025-08-17 21:08:02 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - dates: [2025-08-16, 2025-08-17]
2025-08-17 21:08:02 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - series: [{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}]
2025-08-17 21:08:02 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - Daily count {series=[{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}], categories=[2025-08-16, 2025-08-17]}
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-c8331ead-9361-4afe-aa44-07558ced83cd sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:10:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:10:55 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:10:55 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:10:55 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:10:55 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5cfcb55c]]
2025-08-17 21:10:55 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:10:55 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:10:55 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:10:55 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:25:02 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:25:02 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 7288 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:25:02 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:25:03 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:25:03 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:25:03 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 146 ms. Found 1 JPA repository interface.
2025-08-17 21:25:03 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:25:03 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:25:03 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:25:03 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:25:03 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:25:03 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:25:03 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:25:03 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:25:03 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:25:03 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1335 ms
2025-08-17 21:25:03 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:25:04 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:25:04 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:25:04 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:25:04 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:25:04 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@278cb145
2025-08-17 21:25:04 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:25:04 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:25:04 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:25:05 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:25:05 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:25:05 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:25:06 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:25:06 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:25:06 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@71dc03a]]
2025-08-17 21:25:06 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:25:06 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:25:06 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:25:06 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:25:06 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:25:07 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:25:07 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:25:07 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755437107122
2025-08-17 21:25:07 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:25:07 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 5.152 seconds (process running for 5.961)
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-7cd4006c-3a8a-4d29-a080-a2fb0e3dd933
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=37, memberId='consumer-ws-forwarder-1-7cd4006c-3a8a-4d29-a080-a2fb0e3dd933', protocol='range'}
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 37: {consumer-ws-forwarder-1-7cd4006c-3a8a-4d29-a080-a2fb0e3dd933=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=37, memberId='consumer-ws-forwarder-1-7cd4006c-3a8a-4d29-a080-a2fb0e3dd933', protocol='range'}
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:25:07 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-7cd4006c-3a8a-4d29-a080-a2fb0e3dd933 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:25:19 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:25:19 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:25:19 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:25:19 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:25:19 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@71dc03a]]
2025-08-17 21:25:19 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:25:19 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:25:19 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:25:19 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:25:22 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:25:22 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 37136 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:25:22 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:25:23 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:25:23 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:25:23 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 75 ms. Found 1 JPA repository interface.
2025-08-17 21:25:23 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:25:23 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:25:23 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:25:23 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:25:23 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:25:23 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:25:23 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:25:23 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:25:23 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:25:23 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1053 ms
2025-08-17 21:25:24 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:25:24 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:25:24 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:25:24 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:25:24 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:25:24 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6a7aa675
2025-08-17 21:25:24 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:25:24 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:25:24 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:25:25 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:25:25 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:25:25 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:25:26 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:25:26 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:25:26 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3518882c]]
2025-08-17 21:25:26 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:25:26 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:25:26 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:25:26 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:25:26 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:25:26 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:25:26 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:25:26 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755437126657
2025-08-17 21:25:26 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:25:26 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.258 seconds (process running for 4.912)
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-ae0ea2a9-c5f9-46f9-a54f-fe637521c55a
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=39, memberId='consumer-ws-forwarder-1-ae0ea2a9-c5f9-46f9-a54f-fe637521c55a', protocol='range'}
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 39: {consumer-ws-forwarder-1-ae0ea2a9-c5f9-46f9-a54f-fe637521c55a=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=39, memberId='consumer-ws-forwarder-1-ae0ea2a9-c5f9-46f9-a54f-fe637521c55a', protocol='range'}
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:25:26 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-ae0ea2a9-c5f9-46f9-a54f-fe637521c55a sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:25:28 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:25:28 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:25:28 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:25:28 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:25:28 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@3518882c]]
2025-08-17 21:25:28 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:25:28 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:25:28 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:25:28 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:31:31 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:31:31 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 33796 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:31:31 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:31:32 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:31:32 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:31:32 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 1 JPA repository interface.
2025-08-17 21:31:32 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:31:32 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:31:32 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:31:32 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:31:32 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:31:33 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:31:33 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:31:33 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:31:33 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:31:33 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1063 ms
2025-08-17 21:31:33 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:31:33 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:31:33 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:31:33 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:31:33 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:31:33 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@56b704ea
2025-08-17 21:31:33 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:31:33 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:31:33 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:31:34 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:31:34 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:31:34 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:31:35 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:31:35 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:31:35 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21f4f5d4]]
2025-08-17 21:31:35 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:31:35 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:31:35 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:31:35 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:31:35 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:31:35 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:31:35 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:31:35 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755437495761
2025-08-17 21:31:35 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:31:35 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.24 seconds (process running for 4.829)
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-b61fc19e-d87e-4313-8f21-9abea64a3239
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=41, memberId='consumer-ws-forwarder-1-b61fc19e-d87e-4313-8f21-9abea64a3239', protocol='range'}
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 41: {consumer-ws-forwarder-1-b61fc19e-d87e-4313-8f21-9abea64a3239=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=41, memberId='consumer-ws-forwarder-1-b61fc19e-d87e-4313-8f21-9abea64a3239', protocol='range'}
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:31:36 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-15T16:00:00Z, endDateTime=2025-08-17T21:05:38Z)
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - The found daily count: [MotorNotification(id=86, motorId=MTR-04, timestamp=2025-08-16T03:15:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=87, motorId=MTR-04, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=88, motorId=MTR-05, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=89, motorId=MTR-05, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=90, motorId=MTR-08, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=91, motorId=MTR-03, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=92, motorId=MTR-02, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=93, motorId=MTR-22, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=94, motorId=MTR-22, timestamp=2025-08-16T04:00:00Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.1), MotorNotification(id=95, motorId=MTR-32, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=96, motorId=MTR-32, timestamp=2025-08-16T04:00:00Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.1), MotorNotification(id=97, motorId=MTR-42, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=98, motorId=MTR-42, timestamp=2025-08-16T04:00:00Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=200.1), MotorNotification(id=99, motorId=MTR-41, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=100, motorId=MTR-41, timestamp=2025-08-16T04:00:00Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=200.1), MotorNotification(id=101, motorId=MTR-39, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=102, motorId=MTR-39, timestamp=2025-08-16T04:00:00Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=200.1), MotorNotification(id=103, motorId=MTR-88, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=104, motorId=MTR-88, timestamp=2025-08-16T04:00:00Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=200.1), MotorNotification(id=105, motorId=MTR-05, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=106, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=107, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=108, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=109, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=110, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=111, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=112, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=113, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=114, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=115, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=116, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=117, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.2), MotorNotification(id=118, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=12.2), MotorNotification(id=119, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=120, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=121, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=122, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=123, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=124, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=125, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=126, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=127, motorId=MTR-15, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=11.2), MotorNotification(id=128, motorId=MTR-08, timestamp=2025-08-16T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=3.2), MotorNotification(id=129, motorId=MTR-09, timestamp=2025-08-17T04:00:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=3.2), MotorNotification(id=130, motorId=MTR-18, timestamp=2025-08-17T04:01:00Z, sensorType=VIBRATION_SENSOR, alertType=null, value=3.2), MotorNotification(id=131, motorId=MTR-18, timestamp=2025-08-17T04:01:00Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=300.1), MotorNotification(id=132, motorId=MTR-08, timestamp=2025-08-17T04:01:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=32.2), MotorNotification(id=133, motorId=MTR-08, timestamp=2025-08-17T04:01:01Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=300.1), MotorNotification(id=134, motorId=MTR-08, timestamp=2025-08-17T04:11:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=135, motorId=MTR-18, timestamp=2025-08-17T04:12:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=136, motorId=MTR-18, timestamp=2025-08-17T04:12:01Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=300.1), MotorNotification(id=137, motorId=MTR-18, timestamp=2025-08-17T05:12:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=138, motorId=MTR-18, timestamp=2025-08-17T05:12:01Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=300.1), MotorNotification(id=139, motorId=MTR-28, timestamp=2025-08-17T05:12:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=140, motorId=MTR-28, timestamp=2025-08-17T05:12:01Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=300.1), MotorNotification(id=141, motorId=MTR-28, timestamp=2025-08-17T05:13:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=142, motorId=MTR-28, timestamp=2025-08-17T05:14:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=143, motorId=MTR-28, timestamp=2025-08-17T05:14:01Z, sensorType=VIBRATION_SENSOR, alertType=null, value=20.2), MotorNotification(id=144, motorId=MTR-01, timestamp=2025-08-17T10:37:08Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=145, motorId=MTR-01, timestamp=2025-08-17T10:37:08Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=146, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=147, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=148, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=149, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=150, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=151, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=152, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=153, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=154, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=155, motorId=MTR-01, timestamp=2025-08-17T10:39:50Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=156, motorId=MTR-02, timestamp=2025-08-17T10:50:29Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=157, motorId=MTR-02, timestamp=2025-08-17T10:50:29Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=158, motorId=MTR-03, timestamp=2025-08-17T10:59:47Z, sensorType=VIBRATION_SENSOR, alertType=null, value=10.0), MotorNotification(id=159, motorId=MTR-03, timestamp=2025-08-17T10:59:47Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=160, motorId=MTR-04, timestamp=2025-08-17T10:59:47Z, sensorType=VIBRATION_SENSOR, alertType=null, value=5.0), MotorNotification(id=161, motorId=MTR-04, timestamp=2025-08-17T10:59:47Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0), MotorNotification(id=162, motorId=MTR-01, timestamp=2025-08-17T10:59:48Z, sensorType=VIBRATION_SENSOR, alertType=null, value=5.0), MotorNotification(id=163, motorId=MTR-01, timestamp=2025-08-17T10:59:48Z, sensorType=TEMPERATURE_SENSOR, alertType=null, value=100.0)]
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - dates: [2025-08-16, 2025-08-17]
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - series: [{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}]
2025-08-17 21:31:53 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - Daily count {series=[{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}], categories=[2025-08-16, 2025-08-17]}
2025-08-17 21:32:35 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-b61fc19e-d87e-4313-8f21-9abea64a3239 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:32:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:32:40 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:32:40 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:32:40 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:32:40 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@21f4f5d4]]
2025-08-17 21:32:40 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:32:40 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:32:40 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:32:40 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:33:05 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:33:05 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 32096 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:33:05 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:33:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:33:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:33:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 87 ms. Found 1 JPA repository interface.
2025-08-17 21:33:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:33:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:33:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:33:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 21:33:07 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:33:07 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:33:07 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:33:07 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:33:07 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:33:07 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1131 ms
2025-08-17 21:33:07 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:33:07 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:33:07 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:33:07 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:33:07 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:33:07 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@39f68aec
2025-08-17 21:33:07 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:33:07 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:33:07 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:33:08 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:33:08 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:33:08 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:33:09 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:33:09 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:33:09 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1ac65143]]
2025-08-17 21:33:09 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:33:09 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:33:09 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:33:09 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:33:09 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:33:09 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:33:09 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:33:09 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755437589792
2025-08-17 21:33:09 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:33:09 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.232 seconds (process running for 4.839)
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-fc5bfbec-d1e3-4cdc-b5f6-1c256555a25f
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=43, memberId='consumer-ws-forwarder-1-fc5bfbec-d1e3-4cdc-b5f6-1c256555a25f', protocol='range'}
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 43: {consumer-ws-forwarder-1-fc5bfbec-d1e3-4cdc-b5f6-1c256555a25f=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=43, memberId='consumer-ws-forwarder-1-fc5bfbec-d1e3-4cdc-b5f6-1c256555a25f', protocol='range'}
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:33:10 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:33:22 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:33:22 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:33:22 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:33:22 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:33:22 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T16:00:00Z, endDateTime=2025-08-17T21:05:38Z)
2025-08-17 21:33:23 WARN  [http-nio-8082-exec-1] o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 0, SQLState: 42703
2025-08-17 21:33:23 ERROR [http-nio-8082-exec-1] o.h.e.jdbc.spi.SqlExceptionHelper - ERROR: column "startdatetime" does not exist
  Position: 80
2025-08-17 21:33:23 ERROR [http-nio-8082-exec-1] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [SELECT date(timestamp), motor_id, COUNT(*) from motor_alerts WHERE timestamp > startDateTime AND timestamp <= endDateTime GROUP BY date(timestamp), motor_id] [ERROR: column "startdatetime" does not exist
  Position: 80] [n/a]; SQL [n/a]] with root cause
org.postgresql.util.PSQLException: ERROR: column "startdatetime" does not exist
  Position: 80
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:137)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.AbstractResultSetAccess.getMetaData(AbstractResultSetAccess.java:36)
	at org.hibernate.sql.results.jdbc.internal.AbstractResultSetAccess.getColumnCount(AbstractResultSetAccess.java:52)
	at org.hibernate.query.results.ResultSetMappingImpl.resolve(ResultSetMappingImpl.java:194)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:340)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:34:09 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-fc5bfbec-d1e3-4cdc-b5f6-1c256555a25f sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:34:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:34:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:34:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:34:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:34:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:34:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:34:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:34:35 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:34:35 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:34:35 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:34:35 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1ac65143]]
2025-08-17 21:34:35 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:34:35 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:34:35 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:34:35 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:34:38 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:34:38 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 32624 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:34:38 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:34:38 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:34:38 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:34:38 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 86 ms. Found 1 JPA repository interface.
2025-08-17 21:34:38 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:34:38 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:34:38 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:34:38 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 21:34:39 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:34:39 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:34:39 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:34:39 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:34:39 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:34:39 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1121 ms
2025-08-17 21:34:39 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:34:39 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:34:39 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:34:39 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:34:39 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:34:39 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1e029a04
2025-08-17 21:34:39 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:34:39 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:34:39 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:34:40 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:34:40 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:34:40 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:34:41 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:34:41 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:34:41 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7e93497d]]
2025-08-17 21:34:41 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:34:41 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:34:41 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:34:41 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:34:41 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:34:41 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:34:41 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:34:41 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755437681929
2025-08-17 21:34:41 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:34:42 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.221 seconds (process running for 4.795)
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-01dbdc40-47e9-4241-bdba-03ebde291e3b
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=45, memberId='consumer-ws-forwarder-1-01dbdc40-47e9-4241-bdba-03ebde291e3b', protocol='range'}
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 45: {consumer-ws-forwarder-1-01dbdc40-47e9-4241-bdba-03ebde291e3b=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=45, memberId='consumer-ws-forwarder-1-01dbdc40-47e9-4241-bdba-03ebde291e3b', protocol='range'}
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:34:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-01dbdc40-47e9-4241-bdba-03ebde291e3b sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:34:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:34:47 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:34:47 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:34:47 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:34:47 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7e93497d]]
2025-08-17 21:34:47 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:34:47 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:34:47 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:34:47 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:34:49 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:34:50 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 35360 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:34:50 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:34:50 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:34:50 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:34:50 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 73 ms. Found 1 JPA repository interface.
2025-08-17 21:34:50 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:34:50 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:34:50 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:34:50 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:34:51 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:34:51 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:34:51 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:34:51 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:34:51 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:34:51 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1033 ms
2025-08-17 21:34:51 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:34:51 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:34:51 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:34:51 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:34:51 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:34:51 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@50e8ed74
2025-08-17 21:34:51 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:34:51 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:34:51 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:34:52 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:34:52 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:34:52 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:34:53 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:34:53 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:34:53 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@33bd3549]]
2025-08-17 21:34:53 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:34:53 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:34:53 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:34:53 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:34:53 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:34:53 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:34:53 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:34:53 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755437693818
2025-08-17 21:34:53 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:34:53 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.226 seconds (process running for 4.814)
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-22f756fe-b256-4ac7-bed4-36b6b866b4e4
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=47, memberId='consumer-ws-forwarder-1-22f756fe-b256-4ac7-bed4-36b6b866b4e4', protocol='range'}
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 47: {consumer-ws-forwarder-1-22f756fe-b256-4ac7-bed4-36b6b866b4e4=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=47, memberId='consumer-ws-forwarder-1-22f756fe-b256-4ac7-bed4-36b6b866b4e4', protocol='range'}
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:34:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:35:11 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:35:11 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:35:11 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:35:11 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:35:11 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T17:00:00Z, endDateTime=2025-08-17T21:05:38Z)
2025-08-17 21:35:11 ERROR [http-nio-8082-exec-1] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'] with root cause
org.hibernate.InstantiationException: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.constructor(NativeQueryConstructorTransformer.java:54)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:35:53 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-22f756fe-b256-4ac7-bed4-36b6b866b4e4 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:37:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:37:56 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:37:56 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:37:56 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:37:56 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@33bd3549]]
2025-08-17 21:37:56 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:37:56 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:37:56 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:37:56 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:37:59 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:37:59 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 15924 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:37:59 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:38:00 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:38:00 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:38:00 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 86 ms. Found 1 JPA repository interface.
2025-08-17 21:38:00 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:38:00 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:38:00 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:38:00 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 21:38:00 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:38:00 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:38:00 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:38:00 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:38:00 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:38:00 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1151 ms
2025-08-17 21:38:00 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:38:00 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:38:00 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:38:01 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:38:01 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:38:01 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@66dd04e2
2025-08-17 21:38:01 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:38:01 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:38:01 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:38:02 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:38:02 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:38:02 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:38:03 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:38:03 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:38:03 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68f4c6e7]]
2025-08-17 21:38:03 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:38:03 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:38:03 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:38:03 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:38:03 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:38:03 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:38:03 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:38:03 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755437883726
2025-08-17 21:38:03 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:38:03 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.631 seconds (process running for 5.225)
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-54a1b1f2-538c-4598-93f6-427f596d115f
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=49, memberId='consumer-ws-forwarder-1-54a1b1f2-538c-4598-93f6-427f596d115f', protocol='range'}
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 49: {consumer-ws-forwarder-1-54a1b1f2-538c-4598-93f6-427f596d115f=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=49, memberId='consumer-ws-forwarder-1-54a1b1f2-538c-4598-93f6-427f596d115f', protocol='range'}
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:38:04 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:38:27 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:38:27 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:38:27 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:38:28 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:38:28 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T21:05:38Z)
2025-08-17 21:38:28 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:38:28 ERROR [http-nio-8082-exec-4] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'] with root cause
org.hibernate.InstantiationException: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.constructor(NativeQueryConstructorTransformer.java:54)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:39:03 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-54a1b1f2-538c-4598-93f6-427f596d115f sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:42:55 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:42:55 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:42:55 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:42:55 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:42:55 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68f4c6e7]]
2025-08-17 21:42:55 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:42:55 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:42:55 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:42:55 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:42:58 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:42:58 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 16600 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:42:58 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:42:59 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:42:59 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:42:59 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 76 ms. Found 1 JPA repository interface.
2025-08-17 21:42:59 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:42:59 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:42:59 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:42:59 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:42:59 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:42:59 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:42:59 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:42:59 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:42:59 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:42:59 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1105 ms
2025-08-17 21:42:59 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:42:59 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:42:59 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:43:00 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:43:00 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:43:00 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7c5ac0
2025-08-17 21:43:00 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:43:00 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:43:00 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:43:01 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:43:01 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:43:01 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:43:02 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:43:02 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:43:02 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@139f1db4]]
2025-08-17 21:43:02 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:43:02 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:43:02 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:43:02 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:43:02 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:43:02 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:43:02 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:43:02 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755438182706
2025-08-17 21:43:02 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:43:02 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.555 seconds (process running for 5.132)
2025-08-17 21:43:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:43:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:43:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:43:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-3087b063-ac1f-45d6-bd56-91b53012124b
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=51, memberId='consumer-ws-forwarder-1-3087b063-ac1f-45d6-bd56-91b53012124b', protocol='range'}
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 51: {consumer-ws-forwarder-1-3087b063-ac1f-45d6-bd56-91b53012124b=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=51, memberId='consumer-ws-forwarder-1-3087b063-ac1f-45d6-bd56-91b53012124b', protocol='range'}
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:43:03 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-3087b063-ac1f-45d6-bd56-91b53012124b sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:43:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:43:51 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:43:51 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:43:51 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:43:51 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@139f1db4]]
2025-08-17 21:43:51 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:43:51 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:43:51 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:43:51 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:43:55 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:43:55 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 20852 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:43:55 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:43:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:43:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:43:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 84 ms. Found 1 JPA repository interface.
2025-08-17 21:43:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:43:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:43:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:43:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:43:56 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:43:56 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:43:56 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:43:56 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:43:56 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:43:56 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1206 ms
2025-08-17 21:43:56 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:43:56 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:43:56 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:43:56 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:43:56 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:43:56 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3a3bc0da
2025-08-17 21:43:57 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:43:57 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:43:57 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:43:57 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:43:57 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:43:58 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:43:58 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:43:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:43:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2e90a3de]]
2025-08-17 21:43:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:43:59 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:43:59 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:43:59 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:43:59 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:43:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:43:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:43:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755438239373
2025-08-17 21:43:59 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:43:59 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.686 seconds (process running for 5.284)
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-40431b4f-2835-4b1e-be2c-f2ada0d61843
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=53, memberId='consumer-ws-forwarder-1-40431b4f-2835-4b1e-be2c-f2ada0d61843', protocol='range'}
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 53: {consumer-ws-forwarder-1-40431b4f-2835-4b1e-be2c-f2ada0d61843=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=53, memberId='consumer-ws-forwarder-1-40431b4f-2835-4b1e-be2c-f2ada0d61843', protocol='range'}
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:43:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:44:04 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:44:04 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:44:04 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:44:04 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:44:04 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:06:41Z)
2025-08-17 21:44:04 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:44:04 ERROR [http-nio-8082-exec-1] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'] with root cause
org.hibernate.InstantiationException: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.constructor(NativeQueryConstructorTransformer.java:54)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:44:59 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-40431b4f-2835-4b1e-be2c-f2ada0d61843 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:46:37 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:46:37 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:46:37 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:46:37 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:46:37 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2e90a3de]]
2025-08-17 21:46:37 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:46:37 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:46:37 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:46:37 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:46:41 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:46:41 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 23668 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:46:41 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:46:41 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:46:41 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:46:41 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 77 ms. Found 1 JPA repository interface.
2025-08-17 21:46:41 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:46:41 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:46:41 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:46:41 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:46:42 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:46:42 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:46:42 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:46:42 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:46:42 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:46:42 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1051 ms
2025-08-17 21:46:42 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:46:42 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:46:42 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:46:42 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:46:42 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:46:42 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2d2f09a4
2025-08-17 21:46:42 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:46:42 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:46:42 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:46:43 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:46:43 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:46:44 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:46:44 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:46:44 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:46:44 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6fa73db5]]
2025-08-17 21:46:44 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:46:44 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:46:44 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:46:44 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:46:44 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:46:44 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:46:44 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:46:44 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755438404941
2025-08-17 21:46:44 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:46:45 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.122 seconds (process running for 4.68)
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-4ad4fb2e-5941-4c9d-ac75-69252a52daa9
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=55, memberId='consumer-ws-forwarder-1-4ad4fb2e-5941-4c9d-ac75-69252a52daa9', protocol='range'}
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 55: {consumer-ws-forwarder-1-4ad4fb2e-5941-4c9d-ac75-69252a52daa9=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=55, memberId='consumer-ws-forwarder-1-4ad4fb2e-5941-4c9d-ac75-69252a52daa9', protocol='range'}
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:46:45 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:46:59 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:46:59 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:46:59 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:46:59 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:46:59 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:10:41Z)
2025-08-17 21:46:59 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:47:00 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - The found daily count: [[Ljava.lang.Object;@434eb01a, [Ljava.lang.Object;@7cb9bc7f, [Ljava.lang.Object;@104bd0b1, [Ljava.lang.Object;@77083b71, [Ljava.lang.Object;@41708bea, [Ljava.lang.Object;@701b9dff, [Ljava.lang.Object;@3e1b0515, [Ljava.lang.Object;@87e7214]
2025-08-17 21:47:00 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 21:47:00 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 21:47:00 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 21:47:44 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-4ad4fb2e-5941-4c9d-ac75-69252a52daa9 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:48:08 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:48:08 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:48:08 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:48:08 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:48:08 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6fa73db5]]
2025-08-17 21:48:08 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:48:08 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:48:08 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:48:08 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:48:12 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:48:12 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 37976 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:48:12 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:48:13 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:48:13 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:48:13 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 75 ms. Found 1 JPA repository interface.
2025-08-17 21:48:13 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:48:13 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:48:13 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:48:13 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 21:48:13 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:48:13 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:48:13 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:48:13 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:48:13 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:48:13 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1053 ms
2025-08-17 21:48:13 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:48:13 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:48:13 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:48:13 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:48:14 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:48:14 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@74a74070
2025-08-17 21:48:14 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:48:14 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:48:14 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:48:14 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:48:14 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:48:15 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:48:15 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:48:16 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:48:16 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a9339e5]]
2025-08-17 21:48:16 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:48:16 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:48:16 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:48:16 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:48:16 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:48:16 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:48:16 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:48:16 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755438496311
2025-08-17 21:48:16 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:48:16 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.224 seconds (process running for 4.789)
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-b36f3bda-4f2e-48eb-872c-b1fe27014476
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=57, memberId='consumer-ws-forwarder-1-b36f3bda-4f2e-48eb-872c-b1fe27014476', protocol='range'}
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 57: {consumer-ws-forwarder-1-b36f3bda-4f2e-48eb-872c-b1fe27014476=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=57, memberId='consumer-ws-forwarder-1-b36f3bda-4f2e-48eb-872c-b1fe27014476', protocol='range'}
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:48:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:48:23 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:48:23 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:48:23 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:48:23 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:48:23 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:08:41Z)
2025-08-17 21:48:23 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:48:23 ERROR [http-nio-8082-exec-1] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'] with root cause
org.hibernate.InstantiationException: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.constructor(NativeQueryConstructorTransformer.java:54)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:49:16 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-b36f3bda-4f2e-48eb-872c-b1fe27014476 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:49:27 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:49:27 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:49:27 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:49:27 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:49:27 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a9339e5]]
2025-08-17 21:49:27 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:49:27 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:49:27 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:49:27 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:49:30 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:49:31 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 23748 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:49:31 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:49:31 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:49:31 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:49:31 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 79 ms. Found 1 JPA repository interface.
2025-08-17 21:49:31 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:49:31 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:49:31 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:49:31 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 21:49:32 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:49:32 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:49:32 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:49:32 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:49:32 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:49:32 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1135 ms
2025-08-17 21:49:32 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:49:32 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:49:32 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:49:32 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:49:32 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:49:32 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2d2f09a4
2025-08-17 21:49:32 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:49:32 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:49:32 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:49:33 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:49:33 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:49:33 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:49:34 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:49:34 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:49:34 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7ce87db5]]
2025-08-17 21:49:34 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:49:34 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:49:34 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:49:34 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:49:34 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:49:34 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:49:34 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:49:34 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755438574834
2025-08-17 21:49:34 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:49:34 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.273 seconds (process running for 4.935)
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-6bed4419-50e8-4f7a-b592-893a52c898c4
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=59, memberId='consumer-ws-forwarder-1-6bed4419-50e8-4f7a-b592-893a52c898c4', protocol='range'}
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 59: {consumer-ws-forwarder-1-6bed4419-50e8-4f7a-b592-893a52c898c4=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=59, memberId='consumer-ws-forwarder-1-6bed4419-50e8-4f7a-b592-893a52c898c4', protocol='range'}
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:49:35 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:49:40 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:49:40 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:49:40 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 21:49:40 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:49:40 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:09:41Z)
2025-08-17 21:49:40 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:49:40 ERROR [http-nio-8082-exec-1] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'] with root cause
org.hibernate.InstantiationException: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.constructor(NativeQueryConstructorTransformer.java:54)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:50:34 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-6bed4419-50e8-4f7a-b592-893a52c898c4 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:51:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:51:23 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:51:23 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:51:23 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:51:23 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7ce87db5]]
2025-08-17 21:51:23 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:51:23 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:51:23 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:51:23 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:51:27 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:51:27 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 23464 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:51:27 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:51:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:51:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:51:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 78 ms. Found 1 JPA repository interface.
2025-08-17 21:51:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:51:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:51:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:51:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:51:28 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:51:28 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:51:28 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:51:28 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:51:28 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:51:28 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1102 ms
2025-08-17 21:51:28 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:51:28 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:51:28 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:51:28 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:51:28 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:51:28 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@50e8ed74
2025-08-17 21:51:28 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:51:28 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:51:28 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:51:29 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:51:29 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:51:30 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:51:30 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:51:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:51:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a9339e5]]
2025-08-17 21:51:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:51:30 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:51:30 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:51:30 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:51:30 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:51:30 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:51:30 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:51:30 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755438690983
2025-08-17 21:51:30 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:51:31 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.283 seconds (process running for 4.921)
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-37b30ae6-4b1a-4f40-ab74-1d92fa18c317
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=61, memberId='consumer-ws-forwarder-1-37b30ae6-4b1a-4f40-ab74-1d92fa18c317', protocol='range'}
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 61: {consumer-ws-forwarder-1-37b30ae6-4b1a-4f40-ab74-1d92fa18c317=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=61, memberId='consumer-ws-forwarder-1-37b30ae6-4b1a-4f40-ab74-1d92fa18c317', protocol='range'}
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:51:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:51:48 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:51:48 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:51:48 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:51:48 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:51:48 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:10:41Z)
2025-08-17 21:51:48 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:51:48 ERROR [http-nio-8082-exec-1] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'] with root cause
org.hibernate.InstantiationException: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.constructor(NativeQueryConstructorTransformer.java:54)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:52:30 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-37b30ae6-4b1a-4f40-ab74-1d92fa18c317 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:55:17 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:55:17 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:55:17 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:55:17 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:55:17 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@a9339e5]]
2025-08-17 21:55:17 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:55:17 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:55:17 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:55:17 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:55:20 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:55:20 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 13208 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:55:20 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:55:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:55:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:55:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 77 ms. Found 1 JPA repository interface.
2025-08-17 21:55:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:55:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:55:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:55:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 21:55:21 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:55:21 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:55:21 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:55:21 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:55:21 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:55:21 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1048 ms
2025-08-17 21:55:21 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:55:21 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:55:21 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:55:21 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:55:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:55:22 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6c6919ff
2025-08-17 21:55:22 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:55:22 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:55:22 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:55:22 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:55:22 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:55:23 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:55:23 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:55:24 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:55:24 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@73760b13]]
2025-08-17 21:55:24 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:55:24 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:55:24 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:55:24 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:55:24 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:55:24 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:55:24 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:55:24 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755438924288
2025-08-17 21:55:24 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:55:24 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.14 seconds (process running for 4.718)
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-07f50120-661b-4682-82e3-2a364dbb87c7
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=63, memberId='consumer-ws-forwarder-1-07f50120-661b-4682-82e3-2a364dbb87c7', protocol='range'}
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 63: {consumer-ws-forwarder-1-07f50120-661b-4682-82e3-2a364dbb87c7=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=63, memberId='consumer-ws-forwarder-1-07f50120-661b-4682-82e3-2a364dbb87c7', protocol='range'}
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:55:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:55:51 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:55:51 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:55:51 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-08-17 21:55:51 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:55:51 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:11:41Z)
2025-08-17 21:55:51 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:55:51 ERROR [http-nio-8082-exec-1] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'] with root cause
org.hibernate.InstantiationException: Result class must have a single constructor with exactly 3 parameters 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount'
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.constructor(NativeQueryConstructorTransformer.java:54)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:56:24 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-07f50120-661b-4682-82e3-2a364dbb87c7 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:56:49 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:56:49 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:56:49 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:56:49 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:56:49 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@73760b13]]
2025-08-17 21:56:49 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:56:49 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:56:49 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:56:49 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:56:52 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:56:52 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 34104 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:56:52 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:56:53 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:56:53 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:56:53 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 76 ms. Found 1 JPA repository interface.
2025-08-17 21:56:53 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:56:53 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:56:53 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:56:53 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 21:56:53 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:56:53 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:56:53 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:56:53 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:56:53 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:56:53 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1081 ms
2025-08-17 21:56:53 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:56:54 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:56:54 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:56:54 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:56:54 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:56:54 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@c677d7e
2025-08-17 21:56:54 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:56:54 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:56:54 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:56:55 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:56:55 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:56:55 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:56:55 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:56:56 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:56:56 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5af535ff]]
2025-08-17 21:56:56 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:56:56 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:56:56 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:56:56 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:56:56 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:56:56 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:56:56 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:56:56 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755439016562
2025-08-17 21:56:56 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:56:56 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.235 seconds (process running for 4.831)
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-be9f127d-906f-4c77-b6f8-19107277378d
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=65, memberId='consumer-ws-forwarder-1-be9f127d-906f-4c77-b6f8-19107277378d', protocol='range'}
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 65: {consumer-ws-forwarder-1-be9f127d-906f-4c77-b6f8-19107277378d=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=65, memberId='consumer-ws-forwarder-1-be9f127d-906f-4c77-b6f8-19107277378d', protocol='range'}
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:56:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:57:24 INFO  [http-nio-8082-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:57:24 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:57:24 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 21:57:24 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:57:24 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:12:41Z)
2025-08-17 21:57:25 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:57:25 ERROR [http-nio-8082-exec-2] o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed: org.springframework.orm.jpa.JpaSystemException: Cannot instantiate query result type 'org.example.springbootwebsocketkafkamotornotification.model.DailyCount' due to: argument type mismatch] with root cause
java.lang.ClassCastException: Cannot cast java.sql.Date to java.time.LocalDate
	at java.base/java.lang.Class.cast(Class.java:3523)
	at java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:483)
	at org.hibernate.jpa.spi.NativeQueryConstructorTransformer.transformTuple(NativeQueryConstructorTransformer.java:68)
	at org.hibernate.sql.results.internal.RowTransformerTupleTransformerAdapter.transformRow(RowTransformerTupleTransformerAdapter.java:30)
	at org.hibernate.sql.results.internal.StandardRowReader.readRow(StandardRowReader.java:160)
	at org.hibernate.sql.results.spi.ListResultsConsumer.read(ListResultsConsumer.java:249)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:201)
	at org.hibernate.sql.results.spi.ListResultsConsumer.consume(ListResultsConsumer.java:35)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:224)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:142)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:132)
	at org.hibernate.query.sql.internal.NativeSelectQueryPlanImpl.performList(NativeSelectQueryPlanImpl.java:135)
	at org.hibernate.query.sql.internal.NativeQueryImpl.doList(NativeQueryImpl.java:697)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:130)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy148.findDailyCountByTimestampBetween(Unknown Source)
	at org.example.springbootwebsocketkafkamotornotification.service.MotorNotificationService.getDailyCount(MotorNotificationService.java:29)
	at org.example.springbootwebsocketkafkamotornotification.controller.MotorController.findDailyCount(MotorController.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1447)
2025-08-17 21:57:56 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-be9f127d-906f-4c77-b6f8-19107277378d sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 21:58:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 21:58:02 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 21:58:02 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 21:58:02 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 21:58:02 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5af535ff]]
2025-08-17 21:58:02 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 21:58:02 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:58:02 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 21:58:02 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 21:58:05 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 21:58:05 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 13056 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 21:58:05 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 21:58:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:58:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 21:58:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 1 JPA repository interface.
2025-08-17 21:58:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 21:58:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 21:58:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 21:58:06 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 21:58:06 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 21:58:06 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 21:58:06 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 21:58:06 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 21:58:06 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 21:58:06 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1059 ms
2025-08-17 21:58:06 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 21:58:06 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 21:58:06 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 21:58:07 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 21:58:07 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 21:58:07 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3a3bc0da
2025-08-17 21:58:07 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 21:58:07 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 21:58:07 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 21:58:08 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 21:58:08 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 21:58:08 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 21:58:08 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 21:58:09 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 21:58:09 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4e216b7e]]
2025-08-17 21:58:09 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 21:58:09 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 21:58:09 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 21:58:09 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 21:58:09 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 21:58:09 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 21:58:09 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 21:58:09 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755439089439
2025-08-17 21:58:09 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 21:58:09 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.162 seconds (process running for 4.729)
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-cdabc9fe-3f1c-42b6-a627-659eb4dc57ac
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=67, memberId='consumer-ws-forwarder-1-cdabc9fe-3f1c-42b6-a627-659eb4dc57ac', protocol='range'}
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 67: {consumer-ws-forwarder-1-cdabc9fe-3f1c-42b6-a627-659eb4dc57ac=Assignment(partitions=[machine.notifications-0])}
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=67, memberId='consumer-ws-forwarder-1-cdabc9fe-3f1c-42b6-a627-659eb4dc57ac', protocol='range'}
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 21:58:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:13:41Z)
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - The found daily count: [org.example.springbootwebsocketkafkamotornotification.model.DailyCount@19c47b3e, org.example.springbootwebsocketkafkamotornotification.model.DailyCount@31c69998, org.example.springbootwebsocketkafkamotornotification.model.DailyCount@6fb815ee, org.example.springbootwebsocketkafkamotornotification.model.DailyCount@39d54775, org.example.springbootwebsocketkafkamotornotification.model.DailyCount@372c6fa, org.example.springbootwebsocketkafkamotornotification.model.DailyCount@6fd9555, org.example.springbootwebsocketkafkamotornotification.model.DailyCount@2945f701, org.example.springbootwebsocketkafkamotornotification.model.DailyCount@3ab8f3b3]
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 21:58:16 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 21:59:09 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-cdabc9fe-3f1c-42b6-a627-659eb4dc57ac sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 22:04:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 22:04:57 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 22:04:57 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 22:04:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 22:04:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@4e216b7e]]
2025-08-17 22:04:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 22:04:57 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:04:57 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 22:04:57 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 22:05:01 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 22:05:01 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 15124 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 22:05:01 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 22:05:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:05:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 22:05:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 85 ms. Found 1 JPA repository interface.
2025-08-17 22:05:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:05:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 22:05:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 22:05:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 22:05:02 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 22:05:02 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 22:05:02 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 22:05:02 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 22:05:02 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 22:05:02 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1222 ms
2025-08-17 22:05:02 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 22:05:02 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 22:05:02 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 22:05:03 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 22:05:03 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 22:05:03 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@103478b8
2025-08-17 22:05:03 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 22:05:03 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 22:05:03 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 22:05:04 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 22:05:04 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:05:05 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 22:05:05 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 22:05:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 22:05:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a6aecec]]
2025-08-17 22:05:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 22:05:05 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 22:05:05 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 22:05:05 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 22:05:06 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 22:05:06 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 22:05:06 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 22:05:06 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755439506153
2025-08-17 22:05:06 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 22:05:06 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 5.175 seconds (process running for 5.997)
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-a48d762a-7332-45a1-b50c-943164eb1eb5
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=69, memberId='consumer-ws-forwarder-1-a48d762a-7332-45a1-b50c-943164eb1eb5', protocol='range'}
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 69: {consumer-ws-forwarder-1-a48d762a-7332-45a1-b50c-943164eb1eb5=Assignment(partitions=[machine.notifications-0])}
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=69, memberId='consumer-ws-forwarder-1-a48d762a-7332-45a1-b50c-943164eb1eb5', protocol='range'}
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 22:05:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:14:41Z)
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@373ce08b
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@50bc0c06
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@7c56b651
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@3c90279
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@53a18233
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@63cd687d
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@2ae0ae6b
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@6171bb84
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 22:05:11 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-a48d762a-7332-45a1-b50c-943164eb1eb5 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 22:05:40 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 22:05:40 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 22:05:40 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 22:05:40 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 22:05:40 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a6aecec]]
2025-08-17 22:05:40 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 22:05:40 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:05:40 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 22:05:40 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 22:05:43 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 22:05:43 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 16684 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 22:05:43 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 22:05:44 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:05:44 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 22:05:44 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 80 ms. Found 1 JPA repository interface.
2025-08-17 22:05:44 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:05:44 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 22:05:44 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 22:05:44 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 22:05:44 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 22:05:44 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 22:05:44 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 22:05:44 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 22:05:44 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 22:05:44 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1138 ms
2025-08-17 22:05:44 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 22:05:44 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 22:05:44 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 22:05:45 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 22:05:45 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 22:05:45 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@1e029a04
2025-08-17 22:05:45 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 22:05:45 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 22:05:45 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 22:05:46 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 22:05:46 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:05:46 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 22:05:46 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 22:05:47 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 22:05:47 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a6aecec]]
2025-08-17 22:05:47 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 22:05:47 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 22:05:47 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 22:05:47 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 22:05:47 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 22:05:47 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 22:05:47 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 22:05:47 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755439547559
2025-08-17 22:05:47 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 22:05:47 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.352 seconds (process running for 4.96)
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-933c86c2-9d77-4129-8d40-5f713a1685b4
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=71, memberId='consumer-ws-forwarder-1-933c86c2-9d77-4129-8d40-5f713a1685b4', protocol='range'}
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 71: {consumer-ws-forwarder-1-933c86c2-9d77-4129-8d40-5f713a1685b4=Assignment(partitions=[machine.notifications-0])}
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=71, memberId='consumer-ws-forwarder-1-933c86c2-9d77-4129-8d40-5f713a1685b4', protocol='range'}
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 22:05:47 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:15:41Z)
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@15cba2e3
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@c549bb8
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@2e359764
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@2f5cc5b1
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@67c8b603
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@4f697819
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@4d655827
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - daily count: org.example.springbootwebsocketkafkamotornotification.model.DailyCount@45d6d77
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 22:06:00 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-933c86c2-9d77-4129-8d40-5f713a1685b4 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 22:06:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 22:06:23 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 22:06:23 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 22:06:23 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 22:06:23 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a6aecec]]
2025-08-17 22:06:23 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 22:06:23 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:06:23 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 22:06:23 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 22:06:26 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 22:06:26 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 38020 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 22:06:26 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 22:06:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:06:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 22:06:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 97 ms. Found 1 JPA repository interface.
2025-08-17 22:06:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:06:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 22:06:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 22:06:27 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2025-08-17 22:06:28 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 22:06:28 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 22:06:28 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 22:06:28 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 22:06:28 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 22:06:28 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1312 ms
2025-08-17 22:06:28 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 22:06:28 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 22:06:28 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 22:06:28 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 22:06:28 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 22:06:28 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6c6919ff
2025-08-17 22:06:28 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 22:06:28 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 22:06:28 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 22:06:29 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 22:06:29 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:06:30 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 22:06:30 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 22:06:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 22:06:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12f52ca4]]
2025-08-17 22:06:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 22:06:30 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 22:06:30 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 22:06:30 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 22:06:30 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 22:06:31 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 22:06:31 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 22:06:31 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755439591058
2025-08-17 22:06:31 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 22:06:31 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.608 seconds (process running for 5.268)
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-f94dd148-8e3e-4097-a874-a0eb5272371e
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=73, memberId='consumer-ws-forwarder-1-f94dd148-8e3e-4097-a874-a0eb5272371e', protocol='range'}
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 73: {consumer-ws-forwarder-1-f94dd148-8e3e-4097-a874-a0eb5272371e=Assignment(partitions=[machine.notifications-0])}
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=73, memberId='consumer-ws-forwarder-1-f94dd148-8e3e-4097-a874-a0eb5272371e', protocol='range'}
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 22:06:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:16:41Z)
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-02
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-09
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-08
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-18
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-04
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-03
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-28
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.s.MotorNotificationService - daily count motor id: MTR-01
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 22:06:35 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 22:07:30 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 22:37:30 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 1]
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-f94dd148-8e3e-4097-a874-a0eb5272371e sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 22:39:20 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 22:39:20 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 22:39:20 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 22:39:20 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 22:39:20 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@12f52ca4]]
2025-08-17 22:39:20 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 22:39:20 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:39:20 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 22:39:20 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 22:39:25 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 22:39:25 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 37440 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 22:39:25 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 22:39:26 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:39:26 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 22:39:26 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 87 ms. Found 1 JPA repository interface.
2025-08-17 22:39:26 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:39:26 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 22:39:26 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 22:39:26 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 22:39:26 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 22:39:26 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 22:39:26 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 22:39:26 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 22:39:26 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 22:39:26 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1455 ms
2025-08-17 22:39:26 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 22:39:27 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 22:39:27 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 22:39:27 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 22:39:27 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 22:39:27 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@50e8ed74
2025-08-17 22:39:27 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 22:39:27 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 22:39:27 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 22:39:28 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 22:39:28 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:39:29 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 22:39:29 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 22:39:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 22:39:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@73e054c0]]
2025-08-17 22:39:30 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 22:39:30 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 22:39:30 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 22:39:30 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 22:39:30 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 22:39:30 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 22:39:30 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 22:39:30 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755441570425
2025-08-17 22:39:30 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 22:39:30 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 5.638 seconds (process running for 6.449)
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-ab0431ec-4b64-486e-8f94-c4469088ed4a
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=75, memberId='consumer-ws-forwarder-1-ab0431ec-4b64-486e-8f94-c4469088ed4a', protocol='range'}
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 75: {consumer-ws-forwarder-1-ab0431ec-4b64-486e-8f94-c4469088ed4a=Assignment(partitions=[machine.notifications-0])}
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=75, memberId='consumer-ws-forwarder-1-ab0431ec-4b64-486e-8f94-c4469088ed4a', protocol='range'}
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 22:39:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-16T18:00:00Z, endDateTime=2025-08-17T13:17:41Z)
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-9] o.e.s.s.MotorNotificationService - start date: 2025-08-16T18:00:00Z
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-9] o.e.s.s.MotorNotificationService - dates: [2025-08-17]
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-9] o.e.s.s.MotorNotificationService - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 22:39:35 INFO  [http-nio-8082-exec-9] o.e.s.s.MotorNotificationService - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 22:39:41 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:39:41 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-07-31T18:00:00Z, endDateTime=2025-08-17T13:17:41Z)
2025-08-17 22:39:41 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - start date: 2025-07-31T18:00:00Z
2025-08-17 22:39:41 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - dates: [2025-08-16, 2025-08-17]
2025-08-17 22:39:41 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - series: [{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}]
2025-08-17 22:39:41 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - Daily count {series=[{data=[0, 14], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 2], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}], categories=[2025-08-16, 2025-08-17]}
2025-08-17 22:40:30 INFO  [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-ab0431ec-4b64-486e-8f94-c4469088ed4a sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 22:45:56 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 22:45:56 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 22:45:56 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 22:45:56 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 22:45:56 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@73e054c0]]
2025-08-17 22:45:56 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 22:45:56 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:45:56 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 22:45:56 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 22:46:00 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 22:46:00 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 8136 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 22:46:00 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 22:46:01 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:46:01 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 22:46:01 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 80 ms. Found 1 JPA repository interface.
2025-08-17 22:46:01 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:46:01 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 22:46:01 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 22:46:01 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 22:46:01 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 22:46:01 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 22:46:01 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 22:46:01 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 22:46:01 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 22:46:01 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1212 ms
2025-08-17 22:46:01 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 22:46:01 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 22:46:01 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 22:46:02 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 22:46:02 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 22:46:02 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@50e8ed74
2025-08-17 22:46:02 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 22:46:02 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 22:46:02 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 22:46:03 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 22:46:03 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:46:03 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 22:46:04 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 22:46:04 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 22:46:04 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6fa73db5]]
2025-08-17 22:46:04 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 22:46:04 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 22:46:04 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 22:46:04 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 22:46:04 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 22:46:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 22:46:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 22:46:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755441965019
2025-08-17 22:46:05 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 22:46:05 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 5.027 seconds (process running for 5.789)
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-b244aa38-8c56-41b9-a0cc-4a720cc599b4
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=77, memberId='consumer-ws-forwarder-1-b244aa38-8c56-41b9-a0cc-4a720cc599b4', protocol='range'}
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 77: {consumer-ws-forwarder-1-b244aa38-8c56-41b9-a0cc-4a720cc599b4=Assignment(partitions=[machine.notifications-0])}
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=77, memberId='consumer-ws-forwarder-1-b244aa38-8c56-41b9-a0cc-4a720cc599b4', protocol='range'}
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=35, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 22:46:05 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 22:46:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 22:46:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:46:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:46:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:46:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 22:46:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:46:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:46:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:46:34 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 22:46:34 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 22:46:34 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 22:46:34 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 22:46:34 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:47:04 INFO  [MessageBroker-3] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 12, active threads = 0, queued tasks = 0, completed tasks = 12], outboundChannel[pool size = 2, active threads = 0, queued tasks = 0, completed tasks = 2], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 2, completed tasks = 7]
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-b244aa38-8c56-41b9-a0cc-4a720cc599b4 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 22:47:11 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 22:47:11 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 22:47:11 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 22:47:11 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 22:47:11 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@6fa73db5]]
2025-08-17 22:47:11 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 22:47:11 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:47:11 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 22:47:11 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 22:47:21 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 22:47:21 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 27908 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 22:47:21 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 22:47:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:47:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 22:47:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 83 ms. Found 1 JPA repository interface.
2025-08-17 22:47:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 22:47:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 22:47:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 22:47:21 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 22:47:22 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 22:47:22 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 22:47:22 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 22:47:22 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 22:47:22 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 22:47:22 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1108 ms
2025-08-17 22:47:22 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 22:47:22 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 22:47:22 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 22:47:22 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 22:47:22 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 22:47:22 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@18dbc1b
2025-08-17 22:47:22 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 22:47:22 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 22:47:22 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 22:47:23 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 22:47:23 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 22:47:24 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 22:47:24 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 22:47:24 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 22:47:24 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1fba15d7]]
2025-08-17 22:47:24 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 22:47:24 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 22:47:24 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 22:47:24 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 22:47:24 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 22:47:25 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 22:47:25 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 22:47:25 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755442045058
2025-08-17 22:47:25 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 22:47:25 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.419 seconds (process running for 5.043)
2025-08-17 22:47:25 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 22:47:25 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 22:47:25 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 22:47:25 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 22:47:25 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-83811a9b-d44d-450a-bdba-6a104896a712
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=79, memberId='consumer-ws-forwarder-1-83811a9b-d44d-450a-bdba-6a104896a712', protocol='range'}
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 79: {consumer-ws-forwarder-1-83811a9b-d44d-450a-bdba-6a104896a712=Assignment(partitions=[machine.notifications-0])}
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=79, memberId='consumer-ws-forwarder-1-83811a9b-d44d-450a-bdba-6a104896a712', protocol='range'}
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=37, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 22:47:25 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 22:48:14 INFO  [redisContainer-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:48:14 INFO  [redisContainer-2] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:48:14 INFO  [redisContainer-2] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 temperature issue has been resolved
2025-08-17 22:48:14 INFO  [redisContainer-1] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 vibration issue has been resolved
2025-08-17 22:48:24 INFO  [MessageBroker-5] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 12, active threads = 0, queued tasks = 0, completed tasks = 12], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 2, completed tasks = 13]
2025-08-17 22:53:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 22:53:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:53:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:53:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:53:54 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:02 INFO  [clientInboundChannel-25] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 22:54:02 INFO  [clientInboundChannel-25] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:09 INFO  [redisContainer-3] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:09 INFO  [redisContainer-4] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:09 INFO  [redisContainer-3] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 vibration issue has been resolved
2025-08-17 22:54:09 INFO  [redisContainer-4] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 temperature issue has been resolved
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:54:23 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:46 INFO  [redisContainer-6] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:46 INFO  [redisContainer-5] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:46 INFO  [redisContainer-6] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 temperature issue has been resolved
2025-08-17 22:54:46 INFO  [redisContainer-5] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 vibration issue has been resolved
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-33, timestamp=2025-08-17T14:46:15.476Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}
2025-08-17 22:54:53 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-33, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-33, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T14:46:15.476Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:58 INFO  [redisContainer-7] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:58 INFO  [redisContainer-7] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 vibration issue has been resolved
2025-08-17 22:54:58 INFO  [redisContainer-8] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 22:54:58 INFO  [redisContainer-8] o.e.s.component.RedisDelNotifier - Sending the recovered message MTR-33 temperature issue has been resolved
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-3] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T22:54:02Z)
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-3] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T22:54:02Z)
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - start date: 2025-08-17T00:00:00Z
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-3] o.e.s.s.MotorNotificationService - start date: 2025-08-17T00:00:00Z
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - dates: [2025-08-17]
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-3] o.e.s.s.MotorNotificationService - dates: [2025-08-17]
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}, {data=[9], name=MTR-33}]
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-3] o.e.s.s.MotorNotificationService - series: [{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}, {data=[9], name=MTR-33}]
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-3] o.e.s.s.MotorNotificationService - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}, {data=[9], name=MTR-33}], categories=[2025-08-17]}
2025-08-17 22:58:29 INFO  [http-nio-8082-exec-4] o.e.s.s.MotorNotificationService - Daily count {series=[{data=[14], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[2], name=MTR-04}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}, {data=[9], name=MTR-33}], categories=[2025-08-17]}
2025-08-17 22:58:48 INFO  [http-nio-8082-exec-6] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:58:48 INFO  [http-nio-8082-exec-6] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T14:26:00Z, endDateTime=2025-08-17T22:54:02Z)
2025-08-17 22:58:48 INFO  [http-nio-8082-exec-6] o.e.s.s.MotorNotificationService - start date: 2025-08-17T14:26:00Z
2025-08-17 22:58:48 INFO  [http-nio-8082-exec-6] o.e.s.s.MotorNotificationService - dates: [2025-08-17]
2025-08-17 22:58:48 INFO  [http-nio-8082-exec-6] o.e.s.s.MotorNotificationService - series: [{data=[9], name=MTR-33}]
2025-08-17 22:58:48 INFO  [http-nio-8082-exec-6] o.e.s.s.MotorNotificationService - Daily count {series=[{data=[9], name=MTR-33}], categories=[2025-08-17]}
2025-08-17 22:58:55 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:58:55 INFO  [http-nio-8082-exec-2] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T14:26:00Z, endDateTime=2025-08-17T14:27:28Z)
2025-08-17 22:58:55 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - start date: 2025-08-17T14:26:00Z
2025-08-17 22:58:55 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - dates: []
2025-08-17 22:58:55 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - series: []
2025-08-17 22:58:55 INFO  [http-nio-8082-exec-2] o.e.s.s.MotorNotificationService - Daily count {series=[], categories=[]}
2025-08-17 22:59:13 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:59:13 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T14:26:00Z, endDateTime=2025-08-17T14:47:28Z)
2025-08-17 22:59:13 INFO  [http-nio-8082-exec-7] o.e.s.s.MotorNotificationService - start date: 2025-08-17T14:26:00Z
2025-08-17 22:59:13 INFO  [http-nio-8082-exec-7] o.e.s.s.MotorNotificationService - dates: [2025-08-17]
2025-08-17 22:59:13 INFO  [http-nio-8082-exec-7] o.e.s.s.MotorNotificationService - series: [{data=[9], name=MTR-33}]
2025-08-17 22:59:13 INFO  [http-nio-8082-exec-7] o.e.s.s.MotorNotificationService - Daily count {series=[{data=[9], name=MTR-33}], categories=[2025-08-17]}
2025-08-17 22:59:20 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 22:59:20 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T14:46:00Z, endDateTime=2025-08-17T14:47:28Z)
2025-08-17 22:59:20 INFO  [http-nio-8082-exec-8] o.e.s.s.MotorNotificationService - start date: 2025-08-17T14:46:00Z
2025-08-17 22:59:20 INFO  [http-nio-8082-exec-8] o.e.s.s.MotorNotificationService - dates: [2025-08-17]
2025-08-17 22:59:20 INFO  [http-nio-8082-exec-8] o.e.s.s.MotorNotificationService - series: [{data=[9], name=MTR-33}]
2025-08-17 22:59:20 INFO  [http-nio-8082-exec-8] o.e.s.s.MotorNotificationService - Daily count {series=[{data=[9], name=MTR-33}], categories=[2025-08-17]}
2025-08-17 23:00:13 INFO  [clientInboundChannel-43] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:00:13 INFO  [clientInboundChannel-43] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:15:18 WARN  [HikariPool-1:housekeeper] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=4m55s586ms587µs300ns).
2025-08-17 23:15:18 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response. isDisconnected: false. Rediscovery will be attempted.
2025-08-17 23:15:18 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Requesting disconnect from last known coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 23:15:18 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Client requested disconnect from node 2147483647
2025-08-17 23:15:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 23:15:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) is unavailable or invalid due to cause: coordinator unavailable. isDisconnected: false. Rediscovery will be attempted.
2025-08-17 23:15:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Requesting disconnect from last known coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 23:15:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 23:15:20 INFO  [clientInboundChannel-58] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:15:20 INFO  [clientInboundChannel-58] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-83811a9b-d44d-450a-bdba-6a104896a712 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 23:15:41 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 23:15:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 23:15:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 23:15:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 23:15:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 23:15:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 23:15:42 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 23:15:42 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 23:15:42 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 23:15:42 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 23:15:42 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1fba15d7]]
2025-08-17 23:15:42 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 23:15:42 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 23:15:42 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 23:15:42 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 23:24:24 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 23:24:24 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 32728 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 23:24:24 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 23:24:25 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 23:24:25 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 23:24:25 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 106 ms. Found 1 JPA repository interface.
2025-08-17 23:24:25 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 23:24:25 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 23:24:25 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 23:24:25 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-08-17 23:24:25 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 23:24:25 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 23:24:25 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 23:24:25 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 23:24:25 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 23:24:25 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1445 ms
2025-08-17 23:24:26 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 23:24:26 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 23:24:26 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 23:24:26 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 23:24:26 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 23:24:26 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@51468039
2025-08-17 23:24:26 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 23:24:26 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 23:24:26 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 23:24:27 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 23:24:27 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 23:24:28 INFO  [main] o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-08-17 23:24:28 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 23:24:29 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 23:24:29 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@71dc03a]]
2025-08-17 23:24:29 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 23:24:29 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 23:24:29 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 23:24:29 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 23:24:29 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 23:24:29 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 23:24:29 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 23:24:29 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755444269805
2025-08-17 23:24:29 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 23:24:29 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 5.818 seconds (process running for 6.693)
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-9a08c539-44d2-457b-a16a-8591de4a4027
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=81, memberId='consumer-ws-forwarder-1-9a08c539-44d2-457b-a16a-8591de4a4027', protocol='range'}
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 81: {consumer-ws-forwarder-1-9a08c539-44d2-457b-a16a-8591de4a4027=Assignment(partitions=[machine.notifications-0])}
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=81, memberId='consumer-ws-forwarder-1-9a08c539-44d2-457b-a16a-8591de4a4027', protocol='range'}
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=44, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 23:24:30 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 23:24:30 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 23:24:30 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-11, timestamp=2025-08-17T15:23:20.479Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}
2025-08-17 23:24:30 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:24:30 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-11, timestamp=2025-08-17T15:23:20.479Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 23:24:30 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-11, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T15:23:20.479Z}
2025-08-17 23:24:31 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-11, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:24:31 INFO  [clientInboundChannel-22] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:24:31 INFO  [clientInboundChannel-22] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-11, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:24:32 INFO  [clientInboundChannel-8] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:24:32 INFO  [clientInboundChannel-8] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-11, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:25:29 INFO  [MessageBroker-5] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[3 current WS(3)-HttpStream(0)-HttpPoll(0), 3 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(3)-CONNECTED(3)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 36], outboundChannel[pool size = 8, active threads = 0, queued tasks = 0, completed tasks = 8], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 4, completed tasks = 18]
2025-08-17 23:48:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Disconnecting from node 0 due to request timeout.
2025-08-17 23:48:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cancelled in-flight FETCH request with correlation id 2124 due to node 0 being disconnected (elapsed time since creation: 579310ms, elapsed time since send: 579310ms, throttle time: 0ms, request timeout: 30000ms)
2025-08-17 23:48:48 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) is unavailable or invalid due to cause: coordinator unavailable. isDisconnected: true. Rediscovery will be attempted.
2025-08-17 23:48:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.clients.FetchSessionHandler - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Error sending fetch request (sessionId=3091318, epoch=1815) to node 0:
org.apache.kafka.common.errors.DisconnectException: null
2025-08-17 23:48:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 23:48:52 INFO  [clientInboundChannel-43] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:48:52 INFO  [clientInboundChannel-50] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:48:52 INFO  [clientInboundChannel-43] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-11, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:48:52 INFO  [clientInboundChannel-50] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-11, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:48:53 INFO  [clientInboundChannel-41] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 23:48:53 INFO  [clientInboundChannel-41] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-11, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-11, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T15:23:20.479Z}, {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 23:48:56 WARN  [HikariPool-1:housekeeper] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=9m59s259ms991µs600ns).
2025-08-17 23:55:29 INFO  [MessageBroker-11] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[3 current WS(3)-HttpStream(0)-HttpPoll(0), 6 total, 0 closed abnormally (0 connect failure, 0 send limit, 3 transport error)], stompSubProtocol[processed CONNECT(6)-CONNECTED(6)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 81], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 17], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 4, completed tasks = 523]
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-9a08c539-44d2-457b-a16a-8591de4a4027 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 23:56:51 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 23:56:52 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 23:56:52 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 23:56:52 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 23:56:52 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 23:56:52 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 23:56:52 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 23:56:52 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 23:56:52 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 23:56:52 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 23:56:52 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@71dc03a]]
2025-08-17 23:56:52 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 23:56:52 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 23:56:52 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 23:56:52 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
