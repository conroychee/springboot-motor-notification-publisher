2025-08-17 18:59:19 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 18:59:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 32916 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 18:59:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 1 JPA repository interface.
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 18:59:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 18:59:20 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 18:59:20 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 18:59:20 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 18:59:20 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 18:59:20 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 18:59:20 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1033 ms
2025-08-17 18:59:20 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 18:59:21 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 18:59:21 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 18:59:21 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 18:59:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 18:59:21 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2a510e0e
2025-08-17 18:59:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 18:59:21 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 18:59:21 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 18:59:22 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 18:59:22 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 18:59:23 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 18:59:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 18:59:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@633e4742]]
2025-08-17 18:59:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 18:59:23 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 18:59:23 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 18:59:23 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 18:59:23 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 18:59:23 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 18:59:23 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 18:59:23 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 18:59:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 18:59:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 18:59:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755428363803
2025-08-17 18:59:23 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 18:59:23 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 18:59:23 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 18:59:23 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.409 seconds (process running for 5.34)
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=25, memberId='consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645', protocol='range'}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 25: {consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645=Assignment(partitions=[machine.notifications-0])}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=25, memberId='consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645', protocol='range'}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=29, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 18:59:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-03, timestamp=2025-08-17T10:59:47.581Z, sensorType=VIBRATION_SENSOR, alertType=VERY_HIGH_VIBRATION, value=10.0)
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 18:59:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-03, timestamp=2025-08-17T10:59:47.581Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 19:00:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-b1fe4807-d6f7-4366-913d-3bfd0338a645 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:00:15 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:00:16 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:00:16 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@633e4742]]
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:00:16 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:05:19 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:05:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 6268 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:05:19 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 81 ms. Found 1 JPA repository interface.
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:05:20 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 19:05:20 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:05:20 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:05:20 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:05:20 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:05:20 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:05:20 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1117 ms
2025-08-17 19:05:20 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:05:20 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:05:20 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:05:21 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:05:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:05:21 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@495e8a3
2025-08-17 19:05:21 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:05:21 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:05:21 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:05:22 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:05:22 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:05:23 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:05:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:05:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@23110196]]
2025-08-17 19:05:23 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:05:23 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:05:23 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:05:23 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:05:23 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:05:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:05:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:05:23 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755428723755
2025-08-17 19:05:23 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:05:23 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.698 seconds (process running for 5.592)
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=27, memberId='consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc', protocol='range'}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 27: {consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=27, memberId='consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc', protocol='range'}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:05:24 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:05:25 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:05:25 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:05:25 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-08-17 19:05:25 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:05:25 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - dateMap: {startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T18:40:03Z}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dateMap: {startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T18:40:03Z}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:05:51 INFO  [http-nio-8082-exec-7] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:06:23 INFO  [MessageBroker-6] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(1)], stompBrokerRelay[null], inboundChannel[pool size = 18, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 1, completed tasks = 13]
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-e15c3012-e0fa-4de0-99e9-3315d346f1fc sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:10:57 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:10:57 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@23110196]]
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:10:57 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:11:01 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:11:01 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 40880 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:11:01 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 100 ms. Found 1 JPA repository interface.
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:11:02 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 19:11:02 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:11:02 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:11:02 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:11:02 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:11:03 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:11:03 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1171 ms
2025-08-17 19:11:03 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:11:03 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:11:03 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:11:03 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:11:03 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:11:03 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@5de335cf
2025-08-17 19:11:03 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:11:03 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:11:03 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:11:04 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:11:04 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:11:05 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:11:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:11:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@24456c9e]]
2025-08-17 19:11:05 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:11:05 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:11:05 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:11:05 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:11:05 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:11:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:11:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:11:05 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755429065777
2025-08-17 19:11:05 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:11:05 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.447 seconds (process running for 5.041)
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=29, memberId='consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798', protocol='range'}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 29: {consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=29, memberId='consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798', protocol='range'}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:11:06 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:11:36 INFO  [http-nio-8082-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:11:36 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:11:36 INFO  [http-nio-8082-exec-2] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 19:11:36 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:11:36 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T00:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}]
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-5] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:11:39 INFO  [http-nio-8082-exec-4] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}, {data=[3], name=MTR-08}, {data=[1], name=MTR-09}, {data=[6], name=MTR-18}, {data=[5], name=MTR-28}], categories=[2025-08-17]}
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T11:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - dates: []
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - series: []
2025-08-17 19:12:04 INFO  [http-nio-8082-exec-8] o.e.s.controller.MotorController - Daily count {series=[], categories=[]}
2025-08-17 19:12:05 INFO  [MessageBroker-8] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(1)], stompBrokerRelay[null], inboundChannel[pool size = 18, active threads = 0, queued tasks = 0, completed tasks = 18], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 1, completed tasks = 6]
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-17T10:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - dates: [2025-08-17]
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - series: [{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}]
2025-08-17 19:12:10 INFO  [http-nio-8082-exec-9] o.e.s.controller.MotorController - Daily count {series=[{data=[12], name=MTR-01}, {data=[2], name=MTR-02}, {data=[2], name=MTR-03}], categories=[2025-08-17]}
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-96a5b6c7-2dfd-4244-bd53-3e7a8d63b798 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:13:00 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:13:00 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@24456c9e]]
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:13:00 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:13:04 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:13:04 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 39472 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:13:04 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 84 ms. Found 1 JPA repository interface.
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:13:05 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-08-17 19:13:05 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:13:05 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:05 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:13:05 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:13:05 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:13:05 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1206 ms
2025-08-17 19:13:06 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:13:06 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:13:06 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:13:06 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:13:06 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:13:06 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3cf70afa
2025-08-17 19:13:06 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:13:06 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:13:06 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:13:07 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:13:07 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:08 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:13:08 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:13:08 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@584f12eb]]
2025-08-17 19:13:08 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:13:08 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:08 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:13:08 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:13:08 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:13:08 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:13:08 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:13:08 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755429188990
2025-08-17 19:13:08 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:13:09 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.751 seconds (process running for 5.448)
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=31, memberId='consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1', protocol='range'}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 31: {consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=31, memberId='consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1', protocol='range'}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:13:09 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:13:18 INFO  [http-nio-8082-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:13:18 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:13:18 INFO  [http-nio-8082-exec-1] o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Received the request to get the daily count of motor notifications
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dateMap: DateRequest(startDateTime=2025-08-01T10:00:00Z, endDateTime=2025-08-17T19:11:35Z)
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - dates: [2025-08-16, 2025-08-17]
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - series: [{data=[0, 12], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 0], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}]
2025-08-17 19:13:19 INFO  [http-nio-8082-exec-1] o.e.s.controller.MotorController - Daily count {series=[{data=[0, 12], name=MTR-01}, {data=[1, 2], name=MTR-02}, {data=[1, 2], name=MTR-03}, {data=[2, 0], name=MTR-04}, {data=[3, 0], name=MTR-05}, {data=[2, 3], name=MTR-08}, {data=[0, 1], name=MTR-09}, {data=[22, 0], name=MTR-15}, {data=[0, 6], name=MTR-18}, {data=[2, 0], name=MTR-22}, {data=[0, 5], name=MTR-28}, {data=[2, 0], name=MTR-32}, {data=[2, 0], name=MTR-39}, {data=[2, 0], name=MTR-41}, {data=[2, 0], name=MTR-42}, {data=[2, 0], name=MTR-88}], categories=[2025-08-16, 2025-08-17]}
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-e89c4e87-a6f3-430f-8f9b-e584b3096eb1 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:13:44 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:13:44 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@584f12eb]]
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:13:44 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-08-17 19:13:55 INFO  [background-preinit] o.h.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.2.Final
2025-08-17 19:13:55 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Starting SpringbootWebsocketKafkaMotorNotificationApplication using Java 24.0.2 with PID 16744 (C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification\target\classes started by Conroy in C:\Users\Conroy\OneDrive\Documents\Projects\java\springboot\springboot-websocket-kafka-motor-notification)
2025-08-17 19:13:55 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - No active profile set, falling back to 1 default profile: "default"
2025-08-17 19:13:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:55 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 79 ms. Found 1 JPA repository interface.
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.example.springbootwebsocketkafkamotornotification.repository.MotorRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-08-17 19:13:56 INFO  [main] o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2025-08-17 19:13:56 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8082 (http)
2025-08-17 19:13:56 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:56 INFO  [main] o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-08-17 19:13:56 INFO  [main] o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.43]
2025-08-17 19:13:56 INFO  [main] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-08-17 19:13:56 INFO  [main] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1172 ms
2025-08-17 19:13:56 INFO  [main] o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-08-17 19:13:56 INFO  [main] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.22.Final
2025-08-17 19:13:56 INFO  [main] o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-08-17 19:13:56 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-08-17 19:13:56 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-08-17 19:13:57 INFO  [main] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@23d978b
2025-08-17 19:13:57 INFO  [main] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-08-17 19:13:57 WARN  [main] org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-08-17 19:13:57 INFO  [main] o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 17.5
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-08-17 19:13:57 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-08-17 19:13:57 INFO  [main] o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:13:58 WARN  [main] o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-08-17 19:13:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-08-17 19:13:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@45ec9b22]]
2025-08-17 19:13:59 INFO  [main] o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-08-17 19:13:59 INFO  [main] o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8082"]
2025-08-17 19:13:59 INFO  [main] o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8082 (http) with context path '/'
2025-08-17 19:13:59 INFO  [main] o.a.k.c.consumer.ConsumerConfig - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 5000
	auto.include.jmx.reporter = true
	auto.offset.reset = earliest
	bootstrap.servers = [172.20.153.165:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-ws-forwarder-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	enable.metrics.push = true
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = ws-forwarder
	group.instance.id = null
	group.protocol = classic
	group.remote.assignor = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metadata.recovery.strategy = none
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.max.ms = 1000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.header.urlencode = false
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2, TLSv1.3]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.3
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.springframework.kafka.support.serializer.JsonDeserializer

2025-08-17 19:13:59 INFO  [main] o.a.k.c.t.i.KafkaMetricsCollector - initializing Kafka metrics collector
2025-08-17 19:13:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka version: 3.9.1
2025-08-17 19:13:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka commitId: f745dfdcee2b9851
2025-08-17 19:13:59 INFO  [main] o.a.kafka.common.utils.AppInfoParser - Kafka startTimeMs: 1755429239322
2025-08-17 19:13:59 INFO  [main] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Subscribed to topic(s): machine.notifications
2025-08-17 19:13:59 INFO  [main] o.e.s.SpringbootWebsocketKafkaMotorNotificationApplication - Started SpringbootWebsocketKafkaMotorNotificationApplication in 4.483 seconds (process running for 5.207)
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] org.apache.kafka.clients.Metadata - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Cluster ID: KEIRFvdVTu6WMDyTZ9Z0jA
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: need to re-join with the given member-id: consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] (Re-)joining group
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully joined group with generation Generation{generationId=33, memberId='consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6', protocol='range'}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Finished assignment for group at generation 33: {consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6=Assignment(partitions=[machine.notifications-0])}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Successfully synced group in generation Generation{generationId=33, memberId='consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6', protocol='range'}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Notifying assignor about the new Assignment(partitions=[machine.notifications-0])
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Adding newly assigned partitions: machine.notifications-0
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.internals.ConsumerUtils - Setting offset for partition machine.notifications-0 to the committed offset FetchPosition{offset=31, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.20.153.165:9092 (id: 0 rack: null)], epoch=0}}
2025-08-17 19:13:59 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions assigned: [machine.notifications-0]
2025-08-17 19:14:15 INFO  [http-nio-8082-exec-3] o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-08-17 19:14:15 INFO  [http-nio-8082-exec-3] o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-08-17 19:14:15 INFO  [http-nio-8082-exec-3] o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-08-17 19:14:16 INFO  [clientInboundChannel-10] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:14:16 INFO  [clientInboundChannel-10] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-04, timestamp=2025-08-17T10:59:47.581Z, sensorType=VIBRATION_SENSOR, alertType=HIGH_VIBRATION, value=5.0)
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-04, timestamp=2025-08-17T10:59:47.581Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}
2025-08-17 19:14:48 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:39:50.090Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:14:59 INFO  [MessageBroker-10] o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[1 current WS(1)-HttpStream(0)-HttpPoll(0), 1 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(1)-CONNECTED(1)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 12, active threads = 0, queued tasks = 0, completed tasks = 12], outboundChannel[pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 4], sockJsScheduler[pool size = 12, active threads = 1, queued tasks = 2, completed tasks = 10]
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-01, timestamp=2025-08-17T10:59:48.581Z, sensorType=VIBRATION_SENSOR, alertType=HIGH_VIBRATION, value=5.0)
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:39:50.090Z}]}
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.c.KafkaListenerWebSockerPublisher - Received motor notification from kafka: MotorNotification(id=null, motorId=MTR-01, timestamp=2025-08-17T10:59:48.581Z, sensorType=TEMPERATURE_SENSOR, alertType=HIGH_TEMPERATURE, value=100.0)
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - Hash value serialize: class org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - The motor data to be upserted {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}
2025-08-17 19:15:34 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 19:32:02 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response. isDisconnected: false. Rediscovery will be attempted.
2025-08-17 19:32:02 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Requesting disconnect from last known coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:32:02 INFO  [kafka-coordinator-heartbeat-thread | ws-forwarder] o.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Client requested disconnect from node 2147483647
2025-08-17 19:32:02 WARN  [HikariPool-1:housekeeper] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=6m5s572ms760s).
2025-08-17 19:32:02 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Discovered group coordinator 172.20.153.165:9092 (id: 2147483647 rack: null)
2025-08-17 19:32:04 INFO  [clientInboundChannel-25] o.e.s.controller.WsInitController - Received the request to retrieve the motor notifications snapshot
2025-08-17 19:32:04 INFO  [clientInboundChannel-25] o.e.s.service.RedisCacheService - motor data {motorNotifications=[{alertType=HIGH_VIBRATION, motorId=MTR-01, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-01, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:48.581Z}, {alertType=VERY_HIGH_VIBRATION, motorId=MTR-03, sensorType=VIBRATION_SENSOR, value=10.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-03, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_VIBRATION, motorId=MTR-04, sensorType=VIBRATION_SENSOR, value=5.0, timestamp=2025-08-17T10:59:47.581Z}, {alertType=HIGH_TEMPERATURE, motorId=MTR-04, sensorType=TEMPERATURE_SENSOR, value=100.0, timestamp=2025-08-17T10:59:47.581Z}]}
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerRebalanceListenerInvoker - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Revoke previously assigned partitions machine.notifications-0
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: partitions revoked: [machine.notifications-0]
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Member consumer-ws-forwarder-1-f998b25c-391a-4e57-a3ae-1932b4572db6 sending LeaveGroup request to coordinator 172.20.153.165:9092 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ClassicKafkaConsumer - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Unsubscribed all topics or patterns and assigned partitions
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Resetting generation and member id due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.k.c.c.i.ConsumerCoordinator - [Consumer clientId=consumer-ws-forwarder-1, groupId=ws-forwarder] Request joining group due to: consumer pro-actively leaving the group
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics scheduler closed
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.metrics.JmxReporter
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Closing reporter org.apache.kafka.common.telemetry.internals.ClientTelemetryReporter
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.metrics.Metrics - Metrics reporters closed
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.a.kafka.common.utils.AppInfoParser - App info kafka.consumer for consumer-ws-forwarder-1 unregistered
2025-08-17 19:34:18 INFO  [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] o.s.k.l.KafkaMessageListenerContainer - ws-forwarder: Consumer stopped
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-08-17 19:34:18 INFO  [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopping...
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=false, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@45ec9b22]]
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.m.s.b.SimpleBrokerMessageHandler - Stopped.
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-08-17 19:34:18 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
